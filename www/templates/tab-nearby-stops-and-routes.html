<ion-view view-title="{{data.title}}">
    <ion-nav-buttons side="secondary">
        <button class="button button-clear" ng-click="back()" ng-show="data.returnShow">
            <i class="icon ion-arrow-return-left"></i>
        </button>
    </ion-nav-buttons>
    <ion-content ng-show="data.loaded" has-bouncing="true" scroll="false">
        <div data-tap-disabled="true">
            <leaflet center="center" markers="markers" defaults="defaults" paths="paths" height="{{data.mapHeight}}px" ng-show="data.showMap"></leaflet>
        </div>
        <ion-scroll style="height: {{data.listHeight}}px;" in-view-container>
            <ng-tips ng-model="data.tips"></ng-tips>
            <ion-refresher pulling-text="Pull to refresh..." on-refresh="refresh()" spinner="none"></ion-refresher>
            <ion-spinner ng-if="loading" class="loading center"></ion-spinner>
            <ion-list>
                <ion-item ng-repeat="item in data.stops | orderBy:'dist' | filter:{id: '!current_location'}" id="{{item.id}}" in-view="lineInView($index, $inview, $inviewpart, $event)" in-view-options="{ debounce: 15 }" class="card" style="margin: 0; padding: 0; border-bottom: none;">
                    <div class="item item-divider">{{item.name}}</div>
                    <div class="item item-text-wrap " ng-repeat="r in item.routes" ng-click="showRoutePolylines(r.id); showCurrentStop(r.id, item.id, item.lat, item.lon, item.name);">
                        <div class="row row-center" style="font-size: 13px;">
                            <div class="col">
                                {{r.shortName}}
                                <div ng-repeat="routes in item.arriving" style="display:inline-block;">
                                    <div ng-repeat="ra in routes" ng-if="r.id == ra[0].routeId" style="display:inline-block;" > 
                                        <div style="color: #999; display:inline-block;" class="col">{{ra[0].destination}}</div>
                                        <span ng-hide="!ra[0].expectedArrivalTime">
                                                <strong>{{ra[0].arrivingIn|durationView}}</strong>
                                        </span>
                                        <div ng-repeat="d in ra[0].distance" class="col" style="display:inline-block;">

                                        {{d}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <a class="button button-positive button-small button-clear" href="#/tab/{{url}}/{{item.id}}/{{item.name | encodeStopName}}">See more</a>
                    </div>
                </ion-item>
            </ion-list>
            <p>{{data.notifications}}</p>
        </ion-scroll>
    </ion-content>
</ion-view>