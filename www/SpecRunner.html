<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>Jasmine Spec Runner</title>

    <link rel="stylesheet" href="http://cdn.jsdelivr.net/jasmine/2.0.0/jasmine.css" />

    <!-- Jasmine -->
    <script src="http://cdn.jsdelivr.net/jasmine/2.0.0/jasmine.js"></script>
    <script src="http://cdn.jsdelivr.net/jasmine/2.0.0/jasmine-html.js"></script>
    <script src="http://cdn.jsdelivr.net/jasmine/2.0.0/boot.js"></script>


    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- angular mocks -->
    <script src="https://code.angularjs.org/1.2.16/angular-mocks.js"></script>

    <!-- ngCordova -->
    <script src="lib/ngCordova/dist/ng-cordova.min.js"></script>

    <!-- underscore/underscore-min.js -->
    <script src="lib/underscore/underscore-min.js"></script>

    <!-- leaflet/leflet.js -->
    <script src="lib/leaflet/leaflet.js"></script>
    <script src="lib/leaflet/plugins/Polyline.encoded.js"></script>

    <!-- your app's js -->
    <script src="js/config.js"></script>
    <script src="js/app.js"></script>
    <script src="js/controllers.js"></script>
    <script src="js/services.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/angular-leaflet-directive.min.js"></script>

    <script>
        describe('Filter: encodeStopName', function () {
            var encodeStopName;

            beforeEach(module('starter'));
            beforeEach(inject(function ($filter) {
                encodeStopName = $filter('encodeStopName');
            }));

            it('should be able to replace a forward slash with & character', function () {
                expect(encodeStopName('John St/Smith Ave')).toBe('John St & Smith Ave');
                expect(encodeStopName('Adam Dr/Willson Pl')).toBe('Adam Dr & Willson Pl');
            });

        });

        describe('Function: Is Empty Object?', function () {
            var isEmpty;

            beforeEach(module('starter'));
            beforeEach(inject(function ($filter) {
                isEmpty = $filter('isEmptyObject');
            }));

            it('should detect an empty object', function () {
                var bar;
                var foo = {
                    test: 5
                };
                expect(isEmpty(bar)).toBe(true);
                expect(isEmpty(foo)).toBe(false);
            });

        });


        describe('No Scheduled Service Tests', function () {
            var ctrl, scope;

            beforeEach(module('starter'));
            beforeEach(inject(function ($rootScope, $controller) {
                scope = $rootScope;
                ctrl = $controller('SearchCtrl', {
                    $scope: scope}
                );
            }));

            it('should not return the nssm if only one direction', function(){
                var matches = {"directions": [{"hasUpcomingScheduledService":true}]};
                scope.handleRouteSearch(matches);
                expect(scope.data.notifications).toEqual('');
            });

            it('should display nssm if no service', function() {
                var matches = {"directions": [{"hasUpcomingScheduledService":false}, {"hasUpcomingScheduledService":false}]};
                scope.handleRouteSearch(matches);
                expect(scope.data.notifications).toEqual('');
            });

            it('should not display nssm if active service in one direction', function(){
                var matches = {"directions": [{"hasUpcomingScheduledService":true}, {"hasUpcomingScheduledService":true}]};
                scope.handleRouteSearch(matches);
            });
        });

        describe('Test SearchCtrl', function () {
            var scope, newSearchCtrl, results = [];

            beforeEach(module('starter'));

            beforeEach(inject(function ($rootScope, $controller) {
                scope = $rootScope;

                newSearchCtrl = $controller('SearchCtrl', {
                    $scope: scope
                });
            }));


            it("Results should initially be empty", function () {
                expect(scope.data.results).toEqual(results);
            });
        });

    </script>
</head>

<body></body>

</html>
